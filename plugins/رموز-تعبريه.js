import * as fs from 'fs';

const allowedEmojis = [
  'ğŸ˜‚', 'ğŸ˜', 'ğŸ¥°', 'ğŸ˜˜', 'â¤ï¸', 'ğŸ¤£', 'ğŸ‘', 'ğŸ˜Š', 'ğŸ§', 
  'ğŸ˜', 'ğŸ˜„', 'ğŸ˜ƒ', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜',
  'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜£', 'ğŸ˜¥', 'ğŸ˜®', 'ğŸ˜¯', 'ğŸ˜´', 'ğŸ˜Œ',
  'ğŸ˜›', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ¤¤', 'ğŸ˜’', 'ğŸ˜“', 'ğŸ˜”', 'ğŸ˜•', 'ğŸ™ƒ',
  'ğŸ¤‘', 'ğŸ˜²', 'ğŸ˜–', 'ğŸ˜', 'ğŸ˜Ÿ', 'ğŸ˜¤', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ˜¦',
  'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜©', 'ğŸ˜¬', 'ğŸ˜°', 'ğŸ˜±', 'ğŸ˜³', 'ğŸ˜µ', 'ğŸ˜¡',
  'ğŸ˜ ', 'ğŸ¤¯', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ§', 'ğŸ§', 'ğŸ¤§', 'ğŸ˜‡', 'ğŸ¤ ',
  'ğŸ¤¡', 'ğŸ¤¥', 'ğŸ¤«', 'ğŸ¤­', 'ğŸ§', 'ğŸ¤“', 'ğŸ§', 'ğŸ§', 'ğŸ§',
  'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§',
  'ğŸ§', 'ğŸ¤', 'âœï¸', 'ğŸ’ª', 'ğŸ‘€', 'ğŸ†', 'ğŸ’', 'ğŸ‰', 'ğŸŠ',
  'ğŸ§', 'ğŸ§', 'ğŸ‘¶', 'ğŸ§’', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ§‘', 'ğŸ‘¨', 'ğŸ‘©',
  'ğŸ§”', 'ğŸ‘±', 'ğŸ§“', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ™', 'ğŸ™', 'ğŸ™…', 'ğŸ™†',
  'ğŸ’', 'ğŸ™‹', 'ğŸ§', 'ğŸ™‡', 'ğŸ¤¦', 'ğŸ¤·', 'ğŸ¤´', 'ğŸ‘¸', 'ğŸ¤µ',
  'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§', 'ğŸ§™', 'ğŸ§', 'ğŸ§›', 'ğŸ§œ', 'ğŸ§',
  'ğŸ§', 'ğŸ§', 'ğŸš¶', 'ğŸƒ', 'ğŸ’ƒ', 'ğŸ•º', 'ğŸ§–', 'ğŸ§', 'ğŸ§˜',
  'ğŸ§', 'ğŸ§', 'ğŸ‘«', 'ğŸ§', 'ğŸ§', 'ğŸ’‘', 'ğŸ‘ª', 'ğŸ‘¤', 'ğŸ§',
  'ğŸ¦¸', 'ğŸ¦¹', 'ğŸ§', 'ğŸ§', 'ğŸ¶', 'ğŸ±', 'ğŸ˜¹', 'ğŸ§', 'ğŸ¥‚',
  'ğŸ¦Š', 'â›„', 'ğŸ¤¦â€â™‚ï¸', 'ğŸ‘¼', 'ğŸ¯', 'ğŸ¦', 'ğŸ‘¼', 'ğŸ§', 'ğŸ¸',
  'ğŸµ', 'ğŸ”', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦†', 'ğŸ¦…', 'âœ…',
  'ğŸ’', 'ğŸ’˜', 'ğŸ§', 'ğŸ´', 'ğŸ¦„', 'ğŸŒ¹', 'ğŸ§', 'ğŸ¦‹', 'ğŸŒ',
  'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ', 'ğŸ§', 'ğŸ«¶',
  'ğŸ˜‚', 'ğŸ˜‚', 'ğŸ˜‚', 'ğŸ˜‚', 'ğŸª„', 'ğŸ”«', 'ğŸ', 'ğŸ’', 'ğŸ–¤',
  'ğŸ’—', 'ğŸ€', 'ğŸ¦ˆ', 'â™¥', 'ğŸ‘»', 'ğŸ†', 'ğŸ“¿', 'ğŸ¦¸ğŸ¼â€â™€ï¸', 'ğŸ¦¸ğŸ¼â€â™€ï¸',
  'ğŸ¦¸ğŸ¼â€â™€ï¸', 'ğŸ¥ˆ', 'ğŸ§', 'ğŸ¥‡', 'ğŸ¥Š', 'ğŸ“', 'ğŸ’', 'ğŸ“', 'ğŸ’',
  'ğŸ“', 'ğŸ“'ğŸ¤–, 'ğŸ“', 'ğŸ', 'ğŸ§', 'ğŸ‘¨â€âœˆï¸', 'ğŸ‘', '', 'ğŸ§',
  'ğŸ†', 'ğŸ¿', 'ğŸ§', 'ğŸ™Š', 'ğŸ’', 'ğŸˆ', 'ğŸ‘¨â€âœˆï¸', 'ğŸ‘©â€âœˆï¸', 'ğŸ¦ƒ',
  'ğŸ¦š', 'ğŸ¦œ', 'ğŸ¦¢', 'ğŸ¦©', 'ğŸ•Šï¸', 'ğŸ‘‘', 'ğŸ¥‚', 'ğŸ€', 'ğŸ¦¡',
  'ğŸ™‹â€â™‚ï¸', 'ğŸ§‘', 'ğŸŒ', 'ğŸ§', 'ğŸ§', 'ğŸ‘¼','ğŸ“', 'ğŸŒµ', 'ğŸ„',
  'ğŸ§', 'ğŸ§', 'ğŸŒ´', 'ğŸŒ±', 'ğŸŒ¿', 'â˜˜ï¸', 'ğŸ€', 'ğŸ', 'ğŸ‹',
  'ğŸ§', 'ğŸ§', 'ğŸ', 'ğŸ§', 'ğŸ¤·â€â™‚ï¸', 'ğŸ§', 'ğŸŒ¾', 'ğŸ’', 'ğŸ’‹',
  'ğŸŒ¹', 'ğŸ¥€', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¼', 'ğŸŒ·', 'âš½', 'ğŸ€', 'ğŸˆ'
];

// Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ù…ÙˆØ² ØªØ¹Ø¨ÙŠØ±ÙŠØ© ÙÙŠ Ø§Ù„Ù†Øµ
function hasEmoji(text) {
  const emojiRegex = /[\p{Emoji_Presentation}]/gu;
  return emojiRegex.test(text);
}

export async function before(m, { conn }) {
  if (m.isBaileys && m.fromMe) return true;
  if (!m.isGroup) return false;
  
  // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ù…ÙˆØ² ØªØ¹Ø¨ÙŠØ±ÙŠØ©
  if (m.text && hasEmoji(m.text)) {
    return true;
  }

  // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙØ§Ø±ØºØ© Ø£Ùˆ ØºÙŠØ± Ø§Ù„Ù†ØµÙŠØ©
  if (!m.text || m.text.trim() === '') {
    return true;
  }

  try {
    const randomEmoji = allowedEmojis[Math.floor(Math.random() * allowedEmojis.length)];
    
    await conn.sendMessage(m.chat, {
      react: {
        text: randomEmoji,
        key: m.key
      }
    });

  } catch (error) {
    console.error('Error reacting to message:', error);
  }

  return true;
}